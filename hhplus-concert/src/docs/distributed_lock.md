### Redis 분산 락을 이용한 좌석예약 동시성 제어
#### 1. 좌석 점유 로직의 요구사항
   동시성 제어: 좌석 예약 시 여러 사용자가 동시에 같은 좌석을 요청할 수 있으므로, 좌석을 중복 예약하지 않도록 철저한 동시성 제어가 필요합니다.
   확장성: 다수의 사용자 요청을 처리하기 위해 서버를 확장할 수 있어야 합니다.
#### 2. DB 락의 한계
   DB 부하: DB 락을 사용하여 동시성을 제어하면 좌석 점유 여부를 DB에서 관리하기 때문에 많은 사용자 요청이 집중되면 DB에 부하가 커집니다.
   확장성 문제: DB 락은 특정 DB 서버에서만 관리되므로 여러 서버를 이용해 수평 확장을 할 때 성능 저하가 발생하거나 충돌 문제가 증가할 수 있습니다.
   긴 응답 시간: DB에 락을 걸고 풀기까지 시간이 오래 걸리면 사용자 경험이 저하될 수 있으며, 요청이 많은 경우 락이 점유된 상태로 대기 시간이 길어질 수 있습니다.
#### 3. 좌석 점유 로직에서 Redis 기반 분산락이 적합한 이유
1. 높은 동시성 처리에 적합
   좌석 예약 시스템은 특정 시간에 많은 사용자가 동시에 접근하여 동일한 좌석을 예약하려고 시도할 수 있습니다.
   이때 DB 락을 사용하면 트랜잭션 대기가 발생할 가능성이 크며, DB 성능에 큰 부담이 됩니다.
   Redis 분산락은 비관적 락과 유사하게 락을 점유하면서도 Redis의 높은 처리 성능을 활용해 대기 시간 없이 고성능으로 동시성을 관리할 수 있습니다.
2. 분산 시스템에서의 일관성 보장
   Redis 분산락은 여러 서버에 분산된 인스턴스 간에도 일관성 있게 락을 적용할 수 있습니다.
   분산 환경에서도 여러 서버가 같은 좌석에 동시에 접근하지 못하도록 제어하여 좌석 점유 상태의 데이터 일관성을 유지할 수 있습니다.
3. 락 점유와 해제 관리가 용이
   Redis 락은 **leaseTime(락 유지 시간)**을 설정하여, 서버가 비정상 종료되거나 트랜잭션이 끝나지 않았을 때도 자동으로 락을 해제할 수 있습니다.
   DB 락은 트랜잭션 범위에 의존하여 자원 해제를 관리하는 반면, Redis 분산락은 leaseTime을 통해 특정 시간 이후 자동으로 락을 해제하므로, 예상치 못한 문제에도 대응할 수 있습니다.
4. 성능 최적화와 확장성
   Redis는 인메모리 데이터베이스이기 때문에 락 관리에 있어서 DB 대비 훨씬 빠른 처리 성능을 제공합니다.
   Redis 분산락은 대규모 트래픽 환경에서 성능과 확장성을 보장하며, 좌석 점유와 같은 고성능 실시간 처리가 필요한 로직에 매우 적합합니다.
5. 데드락 방지
   좌석 점유 로직에서 DB 락을 사용하게 되면 데드락이 발생할 가능성이 있습니다.
   Redis 분산락은 leaseTime을 통해 자동으로 락이 해제되기 때문에, 트랜잭션이 예상보다 오래 걸려도 데드락 상태에 빠지지 않도록 방지할 수 있습니다.
   
### 포인트 충전 로직에서 낙관적 락 사용한 이유와 이점
#### 1. 낙관적 락 사용한 이유
- 낙관적 락은 데이터 충돌이 거의 없다고 가정하고 동작하므로, 많은 트랜잭션이 거의 동시에 자원을 갱신할 때 사용됩니다.
- 포인트 충전 작업은 특정 시점에 충돌할 가능성이 적기 때문에, 충돌 발생 시 비용이 크지 않다는 점에서 낙관적 락을 사용했습니다.
- 낙관적 락은 별도의 자원 점유 없이 검증을 수행합니다. 데이터베이스의 버전 필드나 상태 값을 활용하여 변경 시점을 확인하는 방식입니다.

#### 2. 낙관적 락의 이점
성능 최적화: 락을 점유하지 않고도 충돌을 검증할 수 있어, 성능상 부담이 적습니다.
데드락 방지: 자원을 점유하는 시간이 없기 때문에, 데드락과 같은 문제가 발생하지 않습니다.
확장성 향상: 높은 동시성 환경에서도 성능이 저하되지 않으므로, 확장성이 뛰어나고 대규모 트래픽에도 적합합니다.

#### 포인트 충전 로직에 낙관적 락이 적합한 이유
포인트 충전 작업은 동시에 여러 사용자가 요청하더라도, 각 사용자 간의 직접적인 데이터 충돌 가능성이 낮기 때문에 낙관적 락이 유용합니다. 특히, 충돌 발생 시 다른 트랜잭션이 재시도할 수 있게 하여, 불필요한 자원 점유 없이 고성능을 유지하면서도 데이터 일관성을 보장할 수 있습니다.

### 포인트 차감 로직에서 비관적 락 사용한 이유와 이점
1. 동시성 제어와 데이터 일관성 보장
   포인트 차감은 사용자의 포인트 잔액을 감소시키는 작업이므로, 여러 요청이 동시에 발생할 경우 잔액 부족으로 인해 오류가 발생할 수 있습니다.
   비관적 락을 사용하면 데이터에 접근하려는 모든 트랜잭션을 순차적으로 처리하여, 트랜잭션이 완료될 때까지 다른 요청을 대기시킴으로써 데이터의 일관성을 보장합니다.
2. 데이터 충돌 방지
   포인트 차감 로직에서는 동시에 여러 요청이 동일한 사용자 잔액에 접근할 수 있습니다. 비관적 락은 데이터가 사용 중인 동안 다른 트랜잭션의 접근을 차단하여 충돌을 방지할 수 있습니다.
   이렇게 하면 두 요청이 동시에 차감을 시도해 잔액이 부족해지는 상황을 예방할 수 있습니다.
3. 비관적 락은 차감이 끝날 때까지 다른 요청을 대기시키기 때문에, 중복 차감 상황 방지 할 수 있습니다.